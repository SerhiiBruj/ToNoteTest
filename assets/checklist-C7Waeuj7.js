import{r as c,h as C,e as j,u as y,j as l,B as k}from"./index-CuLXS18l.js";import{B as w}from"./bellsIcon-BvJTDUHA.js";import{u as D}from"./useLocalStorage-BdJGbaah.js";import{D as L}from"./doneIcon-CoPAUfYX.js";import{C as N}from"./circle--0a7l64A.js";const B=()=>{const{name:i}=C(),[o,r]=D(`checklist/${i}`),d=j(s=>s.isEditable.value),p=y(),m=()=>{if(d){const s=structuredClone(o);s.forEach(e=>{e.desc.some(a=>a.value==="")||e.desc.push({value:"",done:!1})}),s.some(e=>e.p==="")||s.push({p:"",desc:[{value:"",done:!1}]}),r(s)}else{const s=structuredClone(o).map(e=>({...e,desc:e.desc.map(a=>{var t;return{...a,value:(t=a.value)==null?void 0:t.trim()}}).filter(a=>a.value!=="")})).filter(e=>e.p.trim()!==""&&e.desc.length>0);(o.length!==s.length||o.some((e,a)=>e.desc.length!==o[a].desc.length))&&r(s)}};c.useEffect(()=>{m()},[d]);const f=c.useCallback(s=>{const e=o.filter((a,t)=>t!==s);r(e)},[o,i,r,p]),g=c.useCallback((s,e)=>{const a=o.map((t,n)=>n===s?{...t,desc:t.desc.map((u,h)=>h===e?{...u,done:!u.done}:u)}:t);r(a)},[o,i,r,p]),v=c.useCallback((s,e,a)=>{const t=structuredClone(o).map((n,u)=>u===e?{...n,desc:n.desc.map((h,x)=>x===a?{...h,value:s.target.value}:h)}:n);t[e].desc.some(n=>n.value.trim()==="")||t[e].desc.push({value:"",done:!1}),r(t)},[o,i,r,p]),b=c.useCallback((s,e)=>{const a=structuredClone(o).map((t,n)=>n===e?{...t,p:s.target.value}:t);a.some(t=>t.p.trim()==="")||a.push({p:"",desc:[{value:"",done:!1}]}),r(a)},[o,i,r,p]);return l.jsx("div",{className:"checkList conteiner fileConteiner",onClick:s=>d&&s.stopPropagation(),children:o.map((s,e)=>l.jsxs("ul",{className:"checkLisList",children:[l.jsxs("div",{className:"spbtw",style:{borderBottom:!s.p&&"5px solid gray"},children:[l.jsx("textarea",{onChange:a=>b(a,e),className:`caption texarea ${s.p?"with-after":"noafter"}`,placeholder:"Type in",disabled:!d,value:s.p,style:{padding:10,height:50,margin:0}}),l.jsxs("div",{style:{display:"flex"},children:[l.jsx(w,{size:1.2}),l.jsx("div",{onClick:()=>f(e),children:l.jsx(k,{size:.8,color:"#bfbfbf"})})]})]}),s.desc.map((a,t)=>l.jsx("li",{className:`${a.done?"doned checkLi":"checkLi"}`,style:{paddingTop:20},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[l.jsx("div",{style:{transform:"translate(-20px)"},children:l.jsx(N,{size:20,color:"#bfbfbf"})}),l.jsx("textarea",{value:a.value,disabled:!d,onChange:n=>v(n,e,t),className:"texarea checkLi",style:{borderBottom:!a.value&&"5px solid gray",height:"auto",padding:5,minHeight:30,margin:0,width:"100%"}})]}),l.jsx("div",{onClick:()=>g(e,t),style:{opacity:a.done?1:.5},children:l.jsx(L,{})})]})},t)),l.jsx("hr",{style:{marginTop:50,border:0,width:"100%",height:5,backgroundColor:"#bfbfbf",opacity:"50%"},className:"hr"})]},e))})},$=c.memo(B);export{$ as default};
