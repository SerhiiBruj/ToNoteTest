import{r as h,j as e,C as A,A as w,h as I}from"./index-6vMRcOZg.js";import{u as T}from"./useLocalStorage-oTfYrqNp.js";import{B as v}from"./bellsIcon-BF0PCF7I.js";const M=({clockers:l,setClockers:t})=>{const[i,m]=h.useState(!1),[c,r]=h.useState({fileName:"",type:"counter",goal:""}),s=a=>{const{name:d,value:x}=a.target;r(g=>({...g,[d]:x}))};console.log(l);const o=a=>{if(a.preventDefault(),c.fileName.trim()==="")return;const d={fileName:c.fileName,type:c.type||"counter",goal:c.goal,dateOfStart:new Date().toLocaleDateString("uk-UA",{day:"2-digit",month:"2-digit",year:"numeric"})},x=structuredClone(l.table).map(g=>{switch(c.type){case"clock on":return[...g,[]];case"timer":return[...g,[]];case"check in":return[...g,!1];case"counter":default:return[...g,0]}});t({templates:[...l.templates,d],table:x}),n()},n=()=>{r({fileName:"",type:"counter",goal:""}),m(!1)};return e.jsxs("div",{onClick:()=>{i||m(!0)},className:window.innerWidth<500?"fileIconConteinerOptim addFile":"fileIconConteiner addFile",style:{backgroundColor:"rgb(134, 134, 134)",height:i&&(window.innerWidth>500?350:"60dvw "),width:i&&(window.innerWidth>500?300:"50dvw")},children:[e.jsxs("div",{className:"upperside",style:{height:i&&"20%",transition:"all ease 1s"},children:[e.jsx("span",{className:"fileIconName",children:"Add"}),e.jsx("div",{onClick:()=>{m(a=>!a),r({fileName:"",fileType:"note"})},style:{display:"flex",height:"100%",transition:"all 0.6s ease",alignItems:"center",paddingRight:20,transform:i?"rotate(45deg)  "+(window.innerWidth<500?"scale(0.3)  translateY(-40px) translateX(66%) ":"scale(0.5)"):"rotate(0deg) translateY(15px) translateX(-5%) "+(window.innerWidth<500?"scale(0.7) translateX(10%)":"")},children:e.jsx(A,{color:"#D9D9D9",size:i?.03:.07})})]}),i&&e.jsxs("form",{style:{width:"100%",marginTop:10},onSubmit:o,children:[e.jsx("input",{className:"fileName",name:"fileName",placeholder:"Name",pattern:"[a-zA-Z0-9]{3,20}",value:c.fileName,onChange:s,required:!0}),e.jsxs("select",{className:"fileType",name:"type",value:c.type,onChange:s,children:[e.jsx("option",{value:"counter",children:"counter"}),e.jsx("option",{value:"clock on",children:"clock on"}),e.jsx("option",{value:"check in",children:"check in"}),e.jsx("option",{value:"timer",children:"timer"})]}),e.jsx("input",{className:"fileName",name:"goal",placeholder:"Goal",value:c.goal,onChange:s,required:!0}),e.jsx("button",{type:"submit",className:"submit",children:"Create"})]})]})},S=l=>{if(!l||typeof l!="string")return 0;const[t,i]=l.split(":").map(m=>Number(m));return console.log(t,i),(t*60+i)*60*1e3},C=l=>{let t=0;for(let i=0;i<l.length;i++){const{s:m,e:c}=l[i];if(c===null)continue;const r=S(m),s=S(c);t+=s-r}return t},$=({i:l,clockers:t,setClockers:i})=>{const m=h.useMemo(()=>{if(Array.isArray(t.table[t.table.length-1][l])){let s=0,o=0;for(let n=t.table.length-1;n>=0&&s<30;n--)if(Array.isArray(t.table[n][l])){for(let a=0;a<t.table[n][l].length;a++){const d=C([t.table[n][l][a]]);o+=d}s++}if(s>0){const n=o/s,a=Math.floor(n/(60*60*1e3)),d=Math.floor(n%(60*60*1e3)/(60*1e3));return`${a}:${d.toString().padStart(2,"0")} a day`}else return"0:00 a day"}return"0:00 a day"},[t.table[t.table.length-1][l]]),c=h.useMemo(()=>{if(Array.isArray(t.table[t.table.length-1][l]))try{let s=0;for(let a=t.table.length-1;a>=0&&a>=t.table.length-30;a--){const d=C(t.table[a][l]);d>s&&(s=d)}const o=Math.floor(s/(60*60*1e3)),n=Math.floor(s%(60*60*1e3)/(60*1e3));return console.log(o,n),`${o}:${n}`}catch(s){console.log(s.message)}console.log("useMemo")},[t.table,l]),r=s=>{s.stopPropagation();let o=JSON.parse(JSON.stringify(t));const n=o.table[o.table.length-1][l].length-1,a=o.table[o.table.length-1][l],d=`${String(new Date().getHours()).padStart(2,"0")}:${String(new Date().getMinutes()).padStart(2,"0")}`;if(a[n]&&a[n].e===null)console.log(a[n]),a[n].e=d,console.log(a[n]);else{console.log(a[n]);let x={s:d,e:null};console.log(a[n]),a.push(x)}i(o)};return e.jsxs("div",{className:"clockonConteiner",children:[e.jsxs("div",{className:"clockonConteinerInner",children:[e.jsxs("div",{className:"fsb",children:[e.jsxs("div",{children:[e.jsx("span",{className:"name",children:t.templates[l-1].fileName}),e.jsx("br",{}),e.jsxs("span",{children:["Started:",t.templates[l-1].dateOfStart]})]}),e.jsx(v,{size:1.5})]}),e.jsx(R,{table:t.table,i:l})]}),e.jsx("div",{className:"clockonConteinerInner",children:e.jsxs("div",{className:"fcsb",style:{height:"150%"},children:[e.jsx("div",{className:"fe",children:e.jsx("div",{className:"clockOn",onClick:s=>r(s),style:{textAlign:"center"},size:200,color:"#313131",children:t.table[t.table.length-1][l][0]&&!t.table[t.table.length-1][l][t.table[t.table.length-1][l].length-1].e?`started at ${t.table[t.table.length-1][l][t.table[t.table.length-1][l].length-1].s}`:"ClockOn"})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",justifySelf:"flex-end"},children:[!!t.templates[l-1].goal&&e.jsxs("span",{className:"name",children:["Goal:",t.templates[l-1].goal]}),!!m&&e.jsxs("span",{className:"name",children:["Results: ",m]}),c?e.jsxs("span",{className:"name",children:["Best result: ",c]}):null]})]})})]})},R=({i:l,table:t})=>{const[i,m]=h.useState([[]]),[c,r]=h.useState("");return h.useLayoutEffect(()=>{if(console.log(t[t.length-1][l]),Array.isArray(t[t.length-1][l])){let s=t.map(n=>({date:n[0],value:C(n[l])}));s.length>14&&s.splice(0,s.length-14),r(s[s.length-1].date.split(".")[1]===s[0].date.split(".")[1]?s[0].date.split(".")[1]:s[0].date.split(".")[1]+"-"+s[s.length-1].date.split(".")[1]);const o=new Date(s[0].date.split(".").reverse().join("-"));for(let n=o.getDay();n>0;n--)s.unshift(1);m(s)}},[l,t]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"schedule",children:[e.jsxs("div",{className:"alignedDiv days",children:[e.jsx("div",{children:"s"}),e.jsx("div",{children:"m"}),e.jsx("div",{children:"t"}),e.jsx("div",{children:"w"}),e.jsx("div",{children:"t"}),e.jsx("div",{children:"f"}),e.jsx("div",{children:"s"})]}),e.jsxs("div",{className:"alignedDivConteiner",style:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",paddingBottom:10},children:[e.jsx("div",{className:"alignedDiv",children:i.map((s,o)=>s===1?e.jsx("div",{className:"filler",style:{visibility:"hidden"}},o):e.jsxs("div",{className:"filler",children:[e.jsx("span",{className:"innnerDateIndicator",children:s.date&&s.date.split(".")[0]}),e.jsx("div",{className:"indicator",style:{paddingRight:10,backgroundColor:!s.value>0?"brown":"#1e4f39",color:"lightgray",padding:5,borderRadius:5,paddingBottom:10,fontSize:15,fontFamily:"Times New Roman"},children:Math.floor(s.value/(60*60*1e3))+":"+Math.floor(s.value/(60*1e3))%60})]},o))}),e.jsx("span",{style:{width:"100%",textAlign:"center",alignSelf:"flex-end",color:"lightgray"},children:c})]})]})})},O=({setClockers:l,clockers:t,i})=>{const m=h.useMemo(()=>{let r=0,s=0;for(let o=t.table.length-1;o>=0&&s<30;o--)typeof t.table[o][i]=="boolean"&&t.table[o][i]===!0&&(r+=1),s+=1;if(s>0){const o=r/s,n=o%1===0?1:o.toFixed(1);return`every ${n} day${n>1?"s":""}`}else return"No data"},[t.table,i]),c=h.useCallback(r=>{r.stopPropagation();const s=[...t.table];s[s.length-1][i]=!0,l({...t,table:s}),console.log("clockers"),console.log("handleClick")},[t.table,i]);return e.jsxs("div",{className:"clockonConteiner",children:[e.jsxs("div",{className:"clockonConteinerInner",children:[e.jsxs("div",{className:"fsb",children:[e.jsxs("div",{children:[e.jsx("span",{className:"name",children:t.templates[i-1].fileName}),e.jsx("br",{}),e.jsxs("span",{children:["Started:",t.templates[i-1].dateOfStart]})]}),e.jsx(v,{size:1.5})]}),e.jsx(F,{i,table:t.table})]}),e.jsx("div",{className:"clockonConteinerInner",children:e.jsxs("div",{className:"fcsb",style:{height:"150%"},children:[e.jsx("div",{className:"fe",children:e.jsx("div",{className:"clockOn",onClick:r=>c(r),style:{textAlign:"center"},size:200,color:"#313131",children:t.table[t.table.length-1][i]?"checked in":"check in"})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",justifySelf:"flex-end"},children:[!!t.templates[i-1].goal&&e.jsxs("span",{className:"name",children:["Goal:",t.templates[i-1].goal]}),!!m&&e.jsxs("span",{className:"name",children:["Results: ",m]})]})]})})]})},F=({i:l,table:t})=>{const[i,m]=h.useState([]),[c,r]=h.useState("");return h.useEffect(()=>{let s=t.map(a=>({date:a[0],value:a[l]}));s.length>14&&(s=s.slice(-14));const o=new Date(s[0].date.split(".").reverse().join("-")),n=s[0].date.split(".")[1];for(let a=o.getDay();a>0;a--)s.unshift(1);if(m(s),s.length>0){const a=s[s.length-1].date.split(".")[1];r(n===a?n:`${n}-${a}`)}},[t,l]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"schedule",children:[e.jsxs("div",{className:"alignedDiv days",style:{display:"grid",gap:0,gridTemplateColumns:"repeat(7, 1fr)"},children:[e.jsx("div",{children:"s"}),e.jsx("div",{children:"m"}),e.jsx("div",{children:"t"}),e.jsx("div",{children:"w"}),e.jsx("div",{children:"t"}),e.jsx("div",{children:"f"}),e.jsx("div",{children:"s"})]}),e.jsxs("div",{className:"alignedDiv",style:{display:"flex",flexDirection:"column",gap:0,justifyContent:"space-between",height:"100%",paddingBottom:10},children:[e.jsx("div",{className:"alignedDiv",style:{display:" grid",gridTemplateColumns:" repeat(7, 1fr)"},children:i.map((s,o)=>e.jsx("div",{className:"indicatorCheckIn",style:{visibility:s===1&&"hidden",backgroundColor:s.value?"#1e4f39":"brown"},children:s.date&&s.date.split(".")[0]},o))}),e.jsx("span",{style:{width:"100%",textAlign:"center",alignSelf:"flex-end",color:"lightgray"},children:c})]})]})})},z=({i:l,clockers:t,setClockers:i})=>{console.log("counter");const m=h.useMemo(()=>t.table[t.table.length-1][l]||0,[t.table[t.table.length-1][l]]),c=h.useMemo(()=>!t.table.length||t.length===0?0:(t.table.reduce((n,a)=>n+(a[l]||0),0)/t.table.length).toFixed(1),[t.table,l]),r=h.useMemo(()=>{let n=0;for(let a=t.table.length-1;a>=0;a--){const d=t.table[a][l];typeof d=="number"&&d>n&&(n=d)}return console.log("useMemo"),n===-1/0?null:n},[t.table,l]),s=()=>{const n=[...t.table];n[n.length-1][l]=n[n.length-1][l]+1,i({...t,table:n})},o=()=>{if(t.table[t.table.length-1][l]>0){const n=[...t.table];n[n.length-1][l]=n[n.length-1][l]-1,i({...t,table:n}),console.log("handleClick")}};return e.jsxs("div",{className:"clockonConteiner",children:[e.jsxs("div",{className:"clockonConteinerInner",children:[e.jsxs("div",{className:"fsb",children:[e.jsxs("div",{children:[e.jsx("span",{className:"name",children:t.templates[l-1].fileName}),e.jsx("br",{}),e.jsxs("span",{children:["Started: ",t.templates[l-1].dateOfStart]})]}),e.jsx(v,{size:1.5})]}),e.jsx(E,{i:l,table:t.table,bestResults:r})]}),e.jsx("div",{className:"clockonConteinerInner",children:e.jsxs("div",{className:"fcsb",style:{height:"150%"},children:[e.jsx("div",{className:"fe",children:e.jsxs("div",{className:"clockOn",style:{textAlign:"center",display:"flex",flexDirection:"column",justifyContent:"space-between",height:160,width:160,padding:20},children:[e.jsxs("span",{onClick:s,style:{cursor:"pointer",transform:"rotate(90deg)",display:"flex",justifyContent:"center",alignItems:"center"},children:[e.jsx(w,{size:"2.5vw"})," ",e.jsx("br",{})]}),m,e.jsx("br",{}),e.jsx("span",{onClick:o,style:{cursor:"pointer",transform:"rotate(-90deg)",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(w,{size:"2.5vw"})})]})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",justifySelf:"flex-end"},children:[!!t.templates[l-1].goal&&e.jsxs("span",{className:"name",children:["Goal:",t.templates[l-1].goal]}),!!c&&e.jsxs("span",{className:"name",children:["Results: ",c]}),r?e.jsxs("span",{className:"name",children:["Best result: ",r]}):null]})]})})]})},E=({table:l,i:t,bestResults:i})=>{const[m,c]=h.useState([]);return h.useEffect(()=>{try{const r=l.map((s,o)=>l.length-o<=7?{date:s[0],value:s[t]}:null).filter(s=>s!==null);c(r)}catch(r){console.error(r)}},[l,t]),e.jsx("div",{className:"schedule",children:e.jsx("div",{className:"diagram",style:{display:"flex",height:"100%",justifyContent:"flex-end"},children:m.map((r,s)=>e.jsxs("div",{style:{height:"100%",flex:1,backgroundColor:r?"gray":"lightgray",display:"flex",flexDirection:"column",justifyContent:"flex-end"},children:[e.jsx("div",{style:{background:r.value<b.length?b[r.value]:b[r.value%b.length],transition:"all 0.1s",display:"flex",justifyContent:"center",alignItems:"center",color:"lightgray",width:"100%",height:`${(r.value-0)*75/(i-0)+5}%`,minHeight:"6%"},children:r.value}),e.jsx("div",{style:{alignSelf:"center",height:"20%",background:"#00000052",width:"100%",textAlign:"center",color:"lightgray",display:"flex",justifyContent:"center",alignItems:"center"},children:r.date.split(".")[0]})]},s))})})},b=["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],B=({setClockers:l,clockers:t,i,colors:m})=>{const[c,r]=h.useState(null),[s,o]=h.useState(0),[n,a]=h.useState(!1),[d,x]=h.useState(null),g=h.useMemo(()=>{let u=0;for(let f=t.table.length-1;f>=0&&u<30;f--)Array.isArray(t.table[f][i])&&t.table[f][i].map(p=>{typeof p=="number"&&p>u&&(u=p)});return console.log("useMemo"),u},[t.table]);h.useEffect(()=>{try{let u=0,f=0;for(let p=t.table.length-1;p>0&&f<10;p=p-1)Array.isArray(t.table[p][i])&&t.table[p][i].map(y=>{typeof y=="number"&&(u+=y,f++)});r(f>0?u/f%2===0?u/f:(u/f).toFixed(1):0)}catch(u){console.log(u.message)}console.log("useEffect")},[t.table[t.table.length-1][i]]);const j=h.useCallback(u=>{if(u.stopPropagation(),n){if(clearInterval(d),a(!1),x(null),s>0){let f=[...t.table];Array.isArray(f[f.length-1][i])||(f[f.length-1][i]=[]),f[f.length-1][i].push(s),l({...t,table:f})}o(0)}else{a(!0);const f=setInterval(()=>{o(p=>p+1)},1e3);x(f)}},[d,s]);return e.jsxs("div",{className:"clockonConteiner",children:[e.jsxs("div",{className:"clockonConteinerInner",children:[e.jsxs("div",{className:"fsb",children:[e.jsxs("div",{children:[e.jsx("span",{className:"name",children:t.templates[i-1].fileName}),e.jsx("br",{}),e.jsxs("span",{children:["Started:",t.templates[i-1].dateOfStart]})]}),e.jsx(v,{size:1.5})]}),e.jsx(G,{bestResults:g,i,table:t.table,colors:m})]}),e.jsx("div",{className:"clockonConteinerInner",children:e.jsxs("div",{className:"fcsb",style:{height:"150%"},children:[e.jsx("div",{className:"fe",children:e.jsx("div",{className:"clockOn",onClick:u=>j(u),style:{textAlign:"center"},size:200,color:"#313131",children:n?` ${s} sec`:"Start"})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",justifySelf:"flex-end"},children:[!!t.templates[i-1].goal&&e.jsxs("span",{className:"name",children:["Goal:",t.templates[i-1].goal]}),!!c&&e.jsxs("span",{className:"name",children:["Results: ",c]}),g?e.jsxs("span",{className:"name",children:["Best result: ",g]}):null]})]})})]})},G=({bestResults:l,i:t,table:i,colors:m})=>{const[c,r]=h.useState([]);return h.useEffect(()=>{try{const s=i.map((o,n)=>i.length-n<=7?{date:o[0],value:o[t]}:null).filter(o=>o!==null);r(s.reverse()),console.log("TimerDiagram")}catch(s){console.error(s)}},[i,t]),e.jsx("div",{className:"schedule",children:e.jsx("div",{className:"diagram",style:{display:"flex",height:"100%",flexDirection:"row-reverse",justifyContent:"flex-end"},children:c.map((s,o)=>{let n=0;if(n<4&&s.value.length>0)return e.jsxs("div",{style:{height:"100%",flex:1,backgroundColor:s?"gray":"lightgray",display:"flex",flexDirection:"column",justifyContent:"flex-end"},children:[e.jsx("div",{className:"div",style:{display:"flex",justifyContent:"center",alignItems:"flex-end",height:"80% "},children:Array.isArray(s.value)&&s.value.slice(-4).map((a,d)=>(n<5&&a&&(n+=1),e.jsx("div",{style:{background:m[o],display:"flex",justifyContent:"center",alignItems:"center",color:"lightgray",width:"100%",height:`${Math.min(a/l*100,100)}%`,overflow:"hidden"},children:a},d)))}),e.jsx("div",{style:{alignSelf:"center",height:"20%",background:"#00000052",width:"100%",textAlign:"center",color:"lightgray",display:"flex",justifyContent:"center",alignItems:"center"},children:s.date.split(".")[0]})]},o)})})})},L=()=>{const{name:l}=I(),t=h.useRef(),[i,m]=h.useState(!1),c="dashboard/"+l,[r,s]=T("dashboard/"),o=h.useMemo(()=>[["",...r.templates],...r.table],[i]);function n(a){const d=[],[x,g,j]=a.split(".").map(Number);let u=new Date(j,g-1,x);const f=new Date;for(f.setHours(0,0,0,0),u.setHours(0,0,0,0);u<f;){u.setDate(u.getDate()+1);const p=String(u.getDate()).padStart(2,"0"),y=String(u.getMonth()+1).padStart(2,"0"),D=u.getFullYear();d.push(`${p}.${y}.${D}`)}return d}return h.useEffect(()=>{var d;const a=(d=r.table[r.table.length-1])==null?void 0:d[0];if(a){const x=n(a);if(x.length>0){const g=[...r.table];x.forEach(j=>{let u=[];r.templates.forEach(f=>{switch(f.type){case"clock on":u.push([]);break;case"counter":u.push(0);break;case"timer":u.push([]);break;case"check in":u.push(!1);break;default:u.push(null)}}),g.push([j,...u])}),s({...r,table:g})}}},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"setTableDashBoard",style:{position:"fixed",width:"100%",display:"flex",top:"0px",justifyContent:"flex-end",alignItems:"center"},children:e.jsx("button",{onClick:()=>m(!i),className:"submit",style:{width:"fit-content",margin:10},children:"showTable"})}),i?e.jsx(e.Fragment,{children:e.jsx("div",{className:"conteiner fileConteiner",style:{display:"flex"},onClick:a=>a.stopPropagation(),children:e.jsx("div",{className:"table",ref:t,style:{display:"flex",flexDirection:"column"},children:o.map((a,d)=>e.jsx("div",{className:"tableRow",style:{display:"flex"},children:a.map((x,g)=>d===0||g===0?e.jsxs(e.Fragment,{children:[!g&&d!==0?e.jsx("div",{className:"line",style:{transform:` scaleX(${a.length*2.3}) rotate(-90deg)`}},g):!d&&g!==0?e.jsx("div",{className:"line",style:{transform:` scaleY(${o.length}) `,height:80}},g+111):null,e.jsx("div",{className:"tableCell",style:{marginLeft:`${g*1/25}px`},children:e.jsx("p",{style:{textAlign:" center",overflow:"scroll"},children:d===0?x.fileName:x})},g+201)]}):e.jsx("div",{className:"tableCell",style:{marginLeft:5},children:Array.isArray(x)?typeof x[0]=="object"?x.map(j=>`${j.s}-${j.e}`).join(", "):x.join(", "):typeof x=="boolean"?String(x):x},g+301))},d*1223))})})}):e.jsxs("div",{className:"dashboard fileContainer",children:[r.templates.map((a,d)=>{switch(a.type){case"timer":return e.jsx(B,{colors:N,clockers:r,setClockers:s,i:d+1},d);case"counter":return e.jsx(z,{colors:N,clockers:r,setClockers:s,i:d+1},d);case"clock on":return e.jsx($,{colors:N,clockers:r,setClockers:s,i:d+1},d);case"check in":return e.jsx(O,{clockers:r,setClockers:s,dateOfStart:a.dateOfStart,name:a.name,results:a.results,goal:a.goal,table:r.table,typeName:c,i:d+1},d);default:return null}}),e.jsx("div",{className:"heightCont",children:e.jsx(M,{clockers:r,setClockers:s})})]})]})},X=h.memo(L);let N=["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"];export{X as default};
