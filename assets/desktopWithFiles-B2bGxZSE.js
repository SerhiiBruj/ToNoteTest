import{g as F,u as h,j as t,r as o,a as j,b as E,s as P,d as R,c as D,e as A,f as N,C as O,h as _}from"./index-BSA7hlWv.js";import{B as W}from"./bellsIcon-DiuAOBuk.js";var T={exports:{}},w="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",B=w,L=B;function I(){}function C(){}C.resetWarningCache=I;var z=function(){function e(c,n,m,r,g,u){if(u!==L){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}e.isRequired=e;function s(){return e}var l={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:s,element:e,elementType:e,instanceOf:s,node:e,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:C,resetWarningCache:I};return l.PropTypes=l,l};T.exports=z();var q=T.exports;const b=F(q),Y=({isSelected:e})=>{const{isSelecting:s}=h(l=>l.select);return t.jsx("div",{className:"selcirc",style:{transform:s?"none":"scale(0)",opacity:s?1:0},children:t.jsx("div",{className:"selectCircle",style:{background:e?"rgb(46 46 46 )":"none"}})})},k=e=>{const s=h(a=>a.startAnimation.value),l=h(a=>a.isEditable.value),{isSelecting:c,selected:n}=h(a=>a.select),m=j(),r=o.useRef(),g=E(),[u,i]=o.useState(e.name);o.useEffect(()=>{i(e.name)},[e.name]);const f=o.useCallback(a=>{a.stopPropagation();const d=`${e.type}/${u}`;n.includes(d)?m(R(d)):m(P(d))},[n,m,u,e.type]);o.useEffect(()=>{r.current&&s&&(r.current.style.transition="all ease 0.5s",r.current.style.opacity="0%",r.current.style.transform="scale(0)")},[s]);const y=a=>{i(a.target.value)},p=async(a,d)=>{if(typeof d!="string"||!d.trim()||d===a){i(a.split("/")[1]),console.log("Новий ключ не може бути порожнім або таким самим.");return}if(Object.keys(sessionStorage).includes(d)){console.log(`Ключ "${d}" вже існує.`);return}let x=sessionStorage.getItem(a);if(x!==null){sessionStorage.setItem(d,x),sessionStorage.removeItem(a);const S=localStorage.getItem("token");if(!S){console.log("Токен не знайдено, будь ласка, увійдіть у систему.");return}if(!localStorage.getItem("beLocal"))try{const v=await A.post("http://localhost:3000/rename-uploaded-file",{rnfile:a,newName:d},{headers:{authorization:`Bearer ${S}`}});v.status===200?(console.log("Файл успішно перейменовано"),m(N(Object.keys(sessionStorage)))):console.log("Сталася помилка при перейменуванні файлу:",v.data)}catch(v){console.error("Помилка при зверненні до сервера:",v)}}else localStorage.getItem(a)?(x=localStorage.getItem(a),sessionStorage.setItem(d,x),sessionStorage.removeItem(a)):console.log(`Ключ "${a}" не знайдено.`);i(e.name)},$=o.useCallback(()=>{r.current&&(r.current.style.transition="all ease 0.4s",r.current.style.transform="scale(1.2)",setTimeout(()=>{r.current.style.backgroundColor="#1e1e1e",r.current.style.transform="scale(0)",setTimeout(()=>{m(D()),setTimeout(()=>{g(`${e.type}/${e.name}`)},300)},100)},400))},[g,e.name,e.type,m]);return t.jsx("div",{ref:r,className:"fileIconConteiner",onClick:a=>{a.stopPropagation(),!c&&!l?$():c&&f(a)},onBlur:()=>l&&p(`${e.type}/${e.name}`,`${e.type}/${u}`),children:!s&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{height:"70%",overflow:"hidden"},children:[t.jsx("input",{style:{pointerEvents:l?"all":"none",transition:"0.2s all ease",animation:e.name.length>16&&!l?"scrollText 5s linear infinite":"none"},onChange:y,className:`texarea fileIconName ${e.name.length>16&&"scroll-container"}`,disabled:!l,value:l?u:e.name}),t.jsx("span",{className:"fileIconType",children:e.type})]}),t.jsxs("div",{style:{display:"flex",height:"30%",alignItems:"flex-end",justifyContent:"space-between"},children:[t.jsx("div",{children:t.jsx(Y,{isSelected:n.some(a=>a===`${e.type}/${u}`)})}),t.jsx("div",{style:{display:e.type==="todo"||e.type==="dashboard"||e.type===""?"flex":"none"},children:t.jsx(W,{size:1.3})})]})]})})};k.propTypes={name:b.string.isRequired,type:b.string.isRequired};const U=o.memo(k),V=({size:e,checked:s})=>t.jsx("div",{className:"selcirc",style:{height:`${e}px !important `,width:`${e}px !important `},children:t.jsx("div",{className:"selectCircle",style:{background:s?"rgb(46 46 46 )":"none"}})}),H=e=>e.replace(/[/"'\\%]/g,""),J=()=>{const e=j(),[s,l]=o.useState(!1),c=h(i=>i.startAnimation.value),[n,m]=o.useState({fileName:"",fileType:"note",local:!1}),r=o.useRef(null);o.useEffect(()=>{c&&(r.current.style.animation=" fade 0.6s ease-out")},[c]);const g=o.useCallback(i=>{const{name:f,value:y}=i.target;m(p=>({...p,[f]:H(y)}))},[]),u=o.useCallback(i=>{if(i.preventDefault(),n.fileName.trim()===""){alert("Please enter a file name");return}let f=new Date;const y=(()=>{switch(n.fileType){case"todo":return[];case"note":return"";case"table":return[[n.fileName,""],["",""]];case"checklist":return[];case"dashboard":return{templates:[],table:[[`${String(f.getDate()).padStart(2,"0")}.${String(f.getMonth()+1).padStart(2,"0")}.${f.getFullYear()}`]]};default:return null}})(),p=JSON.stringify(y);localStorage.getItem("beLocal")?localStorage.setItem(`${n.fileType}/${n.fileName}`,p):n.local===!1?sessionStorage.setItem(`${n.fileType}/${n.fileName}`,p):localStorage.setItem(`${n.fileType}/${n.fileName}`,p),l(!1),m({fileName:"",fileType:"note"}),e(N())},[n.fileName,n.fileType]);return t.jsxs("div",{onClick:()=>l(!0),ref:r,className:"fileIconConteiner addFile",style:{height:s&&300,width:s&&340},children:[t.jsxs("div",{className:"upperside",children:[t.jsx("span",{className:"fileIconName",children:"Add"}),t.jsx("div",{onBlur:()=>l(!1),onClick:i=>{i.stopPropagation(),l(f=>!f),m({fileName:"",fileType:"note"})},style:{display:"flex",height:"100%",transition:"all 0.6s ease",alignItems:"center",paddingRight:20,transform:s?"rotate(45deg)":"rotate(0deg) translateY(15px)  translateX(-20px)"},children:t.jsx(O,{color:"#D9D9D9",size:s?.8:1.5})})]}),s&&t.jsxs("form",{onSubmit:u,style:{width:"100%",marginTop:10},children:[t.jsx("input",{className:"fileName",name:"fileName",placeholder:"Name",value:n.fileName,onChange:g}),t.jsxs("select",{className:"fileType",name:"fileType",value:n.fileType,onChange:g,children:[t.jsx("option",{value:"note",children:"note"}),t.jsx("option",{value:"todo",children:"todo"}),t.jsx("option",{value:"table",children:"table"}),t.jsx("option",{value:"dashboard",children:"dashboard"}),t.jsx("option",{value:"checklist",children:"checklist"}),t.jsx("option",{value:"diary",children:"diary"})]}),t.jsxs("label",{htmlFor:"fd",className:"fileIconName",style:{fontSize:25,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:["Save Locally",t.jsx("div",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",height:"100%",width:50},onClick:()=>{m(i=>({...i,local:!n.local}))},children:t.jsx(V,{size:10,checked:n.local})})]}),t.jsx("button",{type:"submit",className:"submit",children:"Create"})]})]})},M=o.memo(J),X=()=>{const e=h(c=>c.pages.value),s=h(c=>c.startAnimation.value),l=j();return o.useEffect(()=>{console.log("useef"),s&&setTimeout(()=>{l(_())},500)},[s]),t.jsx(t.Fragment,{children:t.jsx("div",{style:{width:"100%",display:"flex"},children:t.jsxs("div",{className:"desktopWithFiles",style:{height:"fit-content",background:"none"},children:[e.map((c,n)=>t.jsx(U,{name:c.split("/")[1],type:c.split("/")[0]},n)),t.jsx(M,{})]})})})},Z=o.memo(X);export{Z as default};
