import{r as c,h as y,e as m,j as o,B as C}from"./index-rsXyUzDq.js";import{B as w}from"./bellsIcon-CZcHuNT1.js";import{u as D}from"./useLocalStorage-B1Waq2FL.js";import{D as k}from"./doneIcon-D4iwBO8D.js";import{C as E}from"./circle-BmV_TRb4.js";const L=()=>{const{name:i}=y(),[l,u]=D("checklist/"+i,[]),d=m(e=>e.isEditable.value),f=m(e=>e.showExpo.value);c.useEffect(()=>()=>{console.warn("unmount")},[]),c.useEffect(()=>{if(d){const e=[...l];e.forEach(a=>{a.desc.some(s=>s.value==="")||a.desc.push({value:"",done:!1})}),e.some(a=>a.p==="")||e.push({p:"",desc:[{value:"",done:!1}]}),u(e)}else{const e=l.map(a=>({...a,desc:a.desc.map(s=>{var t;return{...s,value:(t=s.value)==null?void 0:t.trim()}}).filter(s=>s.value!=="")})).filter(a=>a.p.trim()!==""&&a.desc.length>0);u(e)}},[d,i]);const r=c.useCallback(e=>{u(e)},[u,i]),g=c.useCallback(e=>{const a=l.filter((s,t)=>t!==e);r(a)},[l,r,i]),v=c.useCallback((e,a)=>{const s=l.map((t,n)=>n===e?{...t,desc:t.desc.map((p,h)=>h===a?{...p,done:!p.done}:p)}:t);r(s)},[l,r,i]),x=c.useCallback((e,a,s)=>{const t=l.map((n,p)=>p===a?{...n,desc:n.desc.map((h,j)=>j===s?{...h,value:e.target.value}:h)}:n);t[a].desc.some(n=>n.value.trim()==="")||t[a].desc.push({value:"",done:!1}),r(t)},[l,r,i]),b=c.useCallback((e,a)=>{const s=l.map((t,n)=>n===a?{...t,p:e.target.value}:t);s.some(t=>t.p.trim()==="")||s.push({p:"",desc:[{value:"",done:!1}]}),r(s)},[l,r,i]);return o.jsx("div",{className:"checkList conteiner fileConteiner",onClick:e=>(f||d)&&e.stopPropagation(),children:l.map((e,a)=>o.jsxs("ul",{className:"checkLisList",children:[o.jsxs("div",{className:"spbtw",style:{borderBottom:!e.p&&"5px solid gray"},children:[o.jsx("textarea",{onChange:s=>b(s,a),className:`caption texarea ${e.p?"with-after":"noafter"}`,placeholder:"Type in",disabled:!d,value:e.p,style:{padding:10,height:50,margin:0}}),o.jsxs("div",{style:{display:"flex"},children:[o.jsx(w,{size:1.2}),o.jsx("div",{onClick:()=>g(a),children:o.jsx(C,{size:.8,color:"#bfbfbf"})})]})]}),e.desc.map((s,t)=>o.jsx("li",{className:`${s.done?"doned checkLi":"checkLi"}`,style:{paddingTop:20},children:o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[o.jsx("div",{style:{transform:"translate(-20px)"},children:o.jsx(E,{size:20,color:"#bfbfbf"})}),o.jsx("textarea",{value:s.value,disabled:!d,onChange:n=>x(n,a,t),className:"texarea checkLi",style:{borderBottom:!s.value&&"5px solid gray",height:"auto",padding:5,minHeight:30,margin:0,width:"100%"}})]}),o.jsx("div",{onClick:()=>v(a,t),style:{opacity:s.done?1:.5},children:o.jsx(k,{})})]})},t)),o.jsx("hr",{style:{marginTop:50,border:0,width:"100%",height:5,backgroundColor:"#bfbfbf",opacity:"50%"},className:"hr"})]},a))})},P=c.memo(L);export{P as default};
